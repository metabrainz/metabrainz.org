{% extends 'admin/master.html' %}
{% block body %}
  <div class="page-title" style="margin-bottom: 5px;">
    <i class="fa fa-edit"></i> Edit Supporter
  </div>

  <div class="admin-card" style="margin-bottom: 25px;">
    <div class="row">
      <div class="col-sm-8">
        <h2 style="margin-top:0; color: #2d3748; font-weight: 700;">
          {% if supporter.is_commercial %}
            <strong>{{ supporter.org_name }}</strong>
            <small class="text-muted" style="font-size: 18px;">({{ supporter.user.name }})</small>
          {% else %}
            {{ supporter.user.name }}
          {% endif %}
          <span class="badge" style="background-color: #e2e8f0; color: #4a5568; font-size: 14px;">
            #{{ supporter.id }}
          </span>
        </h2>
        <p class="text-muted"><i class="fa fa-calendar"></i> Created on {{ supporter.created.strftime('%Y-%m-%d %H:%M:%S') if supporter.created else 'N/A' }}</p>
      </div>
      {% if supporter.logo_filename %}
        <div class="col-sm-4 text-right">
          <img src="{{ url_for('static', filename='img/logos/supporters/'+supporter.logo_filename) }}"
               class="supporter-logo" style="max-width:280px; max-height:73px;" />
        </div>
      {% elif supporter.org_logo_url %}
        <div class="col-sm-4 text-right">
          <img src="{{ supporter.org_logo_url }}"
               class="supporter-logo" style="max-width:280px; max-height:73px;" />
        </div>
      {% endif %}
    </div>
  </div>

  {% if form.errors %}
    <div class="alert alert-danger alert-dismissible" role="alert" style="margin-bottom: 25px;">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <strong><i class="fa fa-exclamation-triangle"></i> Please correct the following errors:</strong>
      <ul class="mb-0 mt-2">
        {% for field in form.errors %}
          {% for error in form.errors[field] %}
            <li><strong>{{ field }}:</strong> {{ error }}</li>
          {% endfor %}
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form role="form" method="POST" enctype="multipart/form-data">
    {{ form.hidden_tag() if form.hidden_tag }}
    {% if form.csrf_token %}
      {{ form.csrf_token }}
    {% endif %}

    <div class="admin-card">
      <h3><i class="fa fa-info-circle"></i> General info</h3>
      <div class="row">

      <div class="form-group col-md-6">
        <label>Username</label>
        {{ form.username(class="form-control") }}
        <div style="padding-top: 7px">
          <em class="text-muted">
            Determines which user manages this supporter account.
            Can be changed to switch the owner. Only one user can be an owner.
          </em>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label>Name</label>
          {{ form.contact_name(class="form-control") }}
        </div>
        <div class="form-group">
          <label>Email</label>
          {{ form.email(class="form-control") }}
        </div>
      </div>

      </div>
    </div>

    <div class="admin-card">
      <h3><i class="fa fa-database"></i> Data access</h3>
      <div class="row">
        <div class="form-group col-md-6">
          <label>State</label>
          {{ form.state(class="form-control") }}
          <div style="padding-top: 7px">
            <em class="text-muted">
              State determines whether this supporter has access to the MetaBrainz Live Data Feed API.
            </em>
          </div>
        </div>
        <div class="col-md-6">
          <ul class="text-muted">
            <li><code>Active</code> - Full access to the API</li>
            <li><code>Pending</code> - New supporter waiting for approval</li>
            <li><code>Waiting</code> - Old supporter in the waiting list (for approval)</li>
            <li><code>Rejected</code> - Rejected access the API</li>
            <li><code>Limited</code> - Cannot access the API</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="admin-card">
      <h3><i class="fa fa-building"></i> Commercial info</h3>
      <div class="row">

      <div style="font-size:15px;font-weight:bold;margin-bottom:20px" class="col-md-12">
        <div class="checkbox" style="margin: 0;">
          <label style="font-size: 15px; font-weight: 600;">
            {{ form.is_commercial() }}
            This is a commercial supporter
          </label>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label>Organization name</label>
          {{ form.org_name(class="form-control") }}
        </div>
        <div class="form-group">
          <label>URL of the organization's API (if exists)</label>
          {{ form.api_url(class="form-control") }}
        </div>
      </div>

      <div class="form-group col-md-6">
        <label>Description</label>
        {{ form.org_desc(class="form-control", rows=5) }}
      </div>

      </div>
    </div>

    <div class="admin-card">
      <h4><i class="fa fa-map-marker"></i> Address</h4>
      <div class="row">
      <div class="form-group col-md-6">
        <label>Street</label>
        {{ form.address_street(class="form-control") }}
      </div>
      <div class="form-group col-md-6">
        <label>City</label>
        {{ form.address_city(class="form-control") }}
      </div>
      <div class="form-group col-md-6">
        <label>Postcode</label>
        {{ form.address_postcode(class="form-control") }}
      </div>
      <div class="form-group col-md-6">
        <label>State / Province</label>
        {{ form.address_state(class="form-control") }}
      </div>
      <div class="form-group col-md-6">
        <label>Country</label>
        {{ form.address_country(class="form-control") }}
      </div>
      </div>
    </div>

    <div class="admin-card">
      <h4><i class="fa fa-dollar"></i> Financial info</h4>
      <div class="row">
      <div class="form-group col-md-6">
        <label>Tier</label>
        {{ form.tier(class="form-control") }}
      </div>
      <div class="form-group col-md-6">
        <label>Amount pledged</label>
        <div class="input-group">
          <span class="input-group-addon">$</span>
          {{ form.amount_pledged(class="form-control") }}
        </div>
      </div>
      </div>
    </div>

    <div class="admin-card">
      <h3><i class="fa fa-star"></i> Promotion</h3>
      <div class="row">

      <div style="font-size:15px;font-weight:bold;margin-bottom:20px" class="col-md-12">
        <div class="checkbox" style="margin: 0;">
          <label style="font-size: 15px; font-weight: 600;">
            {{ form.featured() }}
            This supporter is featured on the website
          </label>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label>Website URL</label>
          {{ form.website_url(class="form-control") }}
        </div>
        <div class="form-group">
          <label>Logo image file</label>
          {{ form.logo(class="form-control") }}
          <div style="padding-top: 7px">
            <em class="text-muted">
              Logo image that will be displayed on the website. Preferably in the SVG format.
            </em>
          </div>
        </div>
        <div class="form-group">
          <label>Logo URL</label>
          {{ form.logo_url(class="form-control") }}
        </div>
        <div style="margin-top: 20px;">
          <div class="checkbox">
            <label style="font-weight: 600; color: #44a248;">
              {{ form.good_standing() }}
              Good standing
            </label>
          </div>
          <div class="checkbox">
            <label style="font-weight: 600; color: #ed8936;">
              {{ form.in_deadbeat_club() }}
              In the Deadbeat Club
            </label>
          </div>
        </div>
      </div>

      <div class="form-group col-md-6">
        <label>Data usage description</label>
        {{ form.usage_desc(class="form-control", rows=4) }}
        <div style="padding-top: 7px">
          <em class="text-muted">
            Provide a very short (one full sentence) description that includes name of this organization.
          </em>
        </div>
      </div>

      </div>
    </div>

    <div class="admin-card" style="background: #f7fafc; border: 2px solid #e2e8f0; padding: 30px;">
      <div class="text-center">
        <button type="submit" class="btn btn-primary btn-lg" style="min-width: 150px; margin-right: 10px;">
          <i class="fa fa-save"></i> Save Changes
        </button>
        <a href="{{ url_for('supportersview.details', supporter_id=supporter.id) }}" class="btn btn-secondary btn-lg" style="background-color: #e2e8f0 !important; color: #4a5568 !important; border: 1px solid #cbd5e0 !important; min-width: 150px;">
          <i class="fa fa-times"></i> Cancel
        </a>
      </div>
    </div>

  </form>
{% endblock %}
